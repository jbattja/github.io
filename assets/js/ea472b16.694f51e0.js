"use strict";(self.webpackChunk_open_fabric_developer_docs=self.webpackChunk_open_fabric_developer_docs||[]).push([[127],{28453(e,t,n){n.d(t,{R:()=>o,x:()=>r});var a=n(96540);const i={},c=a.createContext(i);function o(e){const t=a.useContext(c);return a.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),a.createElement(c.Provider,{value:t},e.children)}},80833(e,t,n){n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"AccountTokenization/OwnAppTokens/ActivationPreferenceSettings","title":"Own App Tokens","description":"Card activation and setting preference","source":"@site/docs/AccountTokenization/OwnAppTokens/ActivationPreferenceSettings.md","sourceDirName":"AccountTokenization/OwnAppTokens","slug":"/AccountTokenization/OwnAppTokens/ActivationPreferenceSettings","permalink":"/github.io/docs/AccountTokenization/OwnAppTokens/ActivationPreferenceSettings","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"Account Tokenization","permalink":"/github.io/docs/tags/account-tokenization"},{"inline":true,"label":"Own App Tokens","permalink":"/github.io/docs/tags/own-app-tokens"},{"inline":true,"label":"NFC","permalink":"/github.io/docs/tags/nfc"},{"inline":true,"label":"Tap and Pay","permalink":"/github.io/docs/tags/tap-and-pay"}],"version":"current","frontMatter":{"title":"Own App Tokens","tags":["Account Tokenization","Own App Tokens","NFC","Tap and Pay"]},"sidebar":"someSidebar","previous":{"title":"Tokenize an existing card","permalink":"/github.io/docs/AccountTokenization/OwnAppTokens/TokenizeExistingCard"},"next":{"title":"Lifecycle management","permalink":"/github.io/docs/AccountTokenization/OwnAppTokens/LifeCycleManagement"}}');var i=n(74848),c=n(28453);const o={title:"Own App Tokens",tags:["Account Tokenization","Own App Tokens","NFC","Tap and Pay"]},r="Own App Tokens",s={},d=[{value:"Card activation and setting preference",id:"card-activation-and-setting-preference",level:2},{value:"Activating a card",id:"activating-a-card",level:3},{value:"Card preference",id:"card-preference",level:3},{value:"Wallet state change",id:"wallet-state-change",level:3}];function l(e){const t={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,c.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"own-app-tokens",children:"Own App Tokens"})}),"\n",(0,i.jsx)(t.h2,{id:"card-activation-and-setting-preference",children:"Card activation and setting preference"}),"\n",(0,i.jsxs)(t.p,{children:["After the tokenized account is enrolled into the wallet, a card will be added into the wallet and can be fetched via ",(0,i.jsx)(t.code,{children:"Wallet#cards()"})," method. If the card does not need additional authentication, it will also be automatically activated shortly after."]}),"\n",(0,i.jsxs)(t.p,{children:["When the card activation is complete, the ",(0,i.jsx)(t.code,{children:"CardEventListener#onCardActivated(context, cardId)"})," callback will be triggered. At this point, we can set it as the default card for NFC payment."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-kotlin",metastring:'title="Set default card for NFC payment"',children:"wallet.setDefaultCard(cardId)\n"})}),"\n",(0,i.jsx)(t.admonition,{type:"success",children:(0,i.jsxs)(t.p,{children:["The app is now ",(0,i.jsx)(t.strong,{children:"ready"})," to make NFC payments with any NFC enabled payment terminal."]})}),"\n",(0,i.jsx)(t.h3,{id:"activating-a-card",children:"Activating a card"}),"\n",(0,i.jsxs)(t.p,{children:["In some scenarios additional user authentication is required. In such cases, you should ask the customer's consent for NFC payment and prompt them to input the authentication data (for example an OTP) sent to the customer by yourself or the third party issuer. Once the authentication data is collected, you can activate the card manually using the ",(0,i.jsx)(t.code,{children:"Card#activateCard(authenticationData)"})," method."]}),"\n",(0,i.jsx)(t.admonition,{type:"note",children:(0,i.jsx)(t.p,{children:"By default, when tokenizing customer accounts using Open Fabric, we do not require the activation step. However, when creating accounts from existing cards not managed through Open Fabric this activation step is more common."})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-kotlin",metastring:'title="Activating card"',children:"val card = wallet.cards().find {\r\n  it.status == CardStatus.NOT_ACTIVATED && it.isActivationRequired()\r\n}\r\n\r\ncard?.activateCard(authenticationData)\n"})}),"\n",(0,i.jsx)(t.h3,{id:"card-preference",children:"Card preference"}),"\n",(0,i.jsx)(t.p,{children:"A single secure device wallet can provision multiple cards. This section helps you modify the default payment card preference."}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Set default card"}),": ",(0,i.jsx)(t.code,{children:"Wallet#setDefaultCard()"})," method can be used to change the default payment card to the transaction. This function can be called using the identifier of the card."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Get default card"}),": ",(0,i.jsx)(t.code,{children:"Wallet#getDefaultCardId()"})," method can be used to get the identifier of the default card which will be used for transaction processing."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Next payment card"}),": ",(0,i.jsx)(t.code,{children:"Wallet#setNextTransactionCard()"})," method can be used to change the card for the next payment. A card remains set as the next payment card until a payment is performed."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Reset next payment card"}),": ",(0,i.jsx)(t.code,{children:"Wallet#resetNextTransactionCard()"})," method can be used to reset the Card to be used for the next payment to the default card."]}),"\n",(0,i.jsx)(t.h3,{id:"wallet-state-change",children:"Wallet state change"}),"\n",(0,i.jsx)(t.p,{children:"The state of the wallet can be updated from actions triggered from outside of the app. For example, updated from the backend, upon detecting security issues such as a rooted device, tampered application, or changes in device fingerprint.  In order to be aware of any change occurring on the wallet, the hosting app can register a wallet notification listener implementing the WalletNotificationServiceCallback class."}),"\n",(0,i.jsx)(t.p,{children:"The overriding functions of the listener will be called upon the occurrence of the associated events on the wallet:"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"onWalletLocked"}),": Signifying that the customer's wallet has been locked."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"onWalletUnlocked"}),": Indicating that the customer's wallet has been successfully unlocked."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"onWalletDeleted"}),": Triggered when the customer's wallet is deleted."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"onSettingsUpdated"}),": Triggered when wallet settings have been updated."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"onLostEligibility"}),": Triggered when the device loses eligibility for using the wallet"]}),"\n"]}),"\n",(0,i.jsx)(t.admonition,{type:"note",children:(0,i.jsxs)(t.p,{children:["The registration of the listener is done by declaring the listener class in your manifest file under the key ",(0,i.jsx)(t.code,{children:"co.openfabric.nfc.WalletNotificationListener"}),", as shown below:"]})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-xml",metastring:'title="AndroidManifest.xml"',children:'<meta-data\r\n    android:name="co.openfabric.nfc.WalletNotificationListener"            \r\n    android:value="mypackage.MyWalletNotificationListener" />\n'})})]})}function h(e={}){const{wrapper:t}={...(0,c.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}}}]);