"use strict";(self.webpackChunk_open_fabric_developer_docs=self.webpackChunk_open_fabric_developer_docs||[]).push([[1483],{28453(e,n,i){i.d(n,{R:()=>o,x:()=>s});var t=i(96540);const a={},r=t.createContext(a);function o(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),t.createElement(r.Provider,{value:n},e.children)}},82148(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"ProcessingPayments/ReversalNotifications","title":"Reversal notifications","description":"The network may reverse a previously-approved authorization (for example, due to timeout/technical failure, or a merchant reversal). When Open Fabric receives these events, we forward them to you as reversal notifications.","source":"@site/docs/ProcessingPayments/ReversalNotifications.md","sourceDirName":"ProcessingPayments","slug":"/ProcessingPayments/ReversalNotifications","permalink":"/github.io/docs/ProcessingPayments/ReversalNotifications","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"Payment Processing","permalink":"/github.io/docs/tags/payment-processing"},{"inline":true,"label":"Reversal Notifications","permalink":"/github.io/docs/tags/reversal-notifications"}],"version":"current","frontMatter":{"title":"Reversal notifications","tags":["Payment Processing","Reversal Notifications"]},"sidebar":"someSidebar","previous":{"title":"Authorization messages","permalink":"/github.io/docs/ProcessingPayments/AuthorizationMessages"},"next":{"title":"Clearing Reports","permalink":"/github.io/docs/ProcessingPayments/Clearing"}}');var a=i(74848),r=i(28453);const o={title:"Reversal notifications",tags:["Payment Processing","Reversal Notifications"]},s="Reversal notifications",c={},l=[{value:"Types of reversal notifications",id:"types-of-reversal-notifications",level:2},{value:"Final authorization reversal",id:"final-authorization-reversal",level:3},{value:"Pre-authorization reversal",id:"pre-authorization-reversal",level:3},{value:"Authorization failed notification",id:"authorization-failed-notification",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"reversal-notifications",children:"Reversal notifications"})}),"\n",(0,a.jsxs)(n.p,{children:["The network may reverse a previously-approved authorization (for example, due to timeout/technical failure, or a merchant reversal). When Open Fabric receives these events, we forward them to you as ",(0,a.jsx)(n.strong,{children:"reversal notifications"}),"."]}),"\n",(0,a.jsx)(n.p,{children:"These notifications are real-time. You are expected to update the relevant ledgers and customer accounts."}),"\n",(0,a.jsx)(n.admonition,{type:"tip",children:(0,a.jsx)(n.p,{children:"Most commonly, reversal notifications are sent shortly after an authorization (for example, due to a network failure). However, merchants may also reverse an authorization later, potentially days later. As such, you should design your system to be able to process reversals at any time until an authorization expires."})}),"\n",(0,a.jsxs)(n.p,{children:["You must implement a REST endpoint (webhook) to receive these notifications. Upon receiving a reversal notification, acknowledge receipt by responding with ",(0,a.jsx)(n.code,{children:"200 OK"})," within 60 seconds. If we do not receive a ",(0,a.jsx)(n.code,{children:"200 OK"}),", we will assume there was an issue with your systems and will retry the notification according to our retry logic."]}),"\n",(0,a.jsxs)(n.p,{children:["Use ",(0,a.jsx)(n.code,{children:"notification_id"})," to prevent duplicate processing. See ",(0,a.jsx)(n.a,{href:"../Getting-Started/Notifications",children:"Notifications"})," for more information."]}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsx)(n.p,{children:"It is possible to receive reversal notifications for authorizations you've declined. In this case, you do not need to update any ledgers in your system."})}),"\n",(0,a.jsx)(n.h2,{id:"types-of-reversal-notifications",children:"Types of reversal notifications"}),"\n",(0,a.jsx)(n.h3,{id:"final-authorization-reversal",children:"Final authorization reversal"}),"\n",(0,a.jsx)(n.p,{children:"For a final authorization approval, there can only be one final authorization reversal notification (for the full amount). When receiving this notification, reverse the original final authorization (for example, credit back the deducted amount)."}),"\n",(0,a.jsxs)(n.p,{children:["Please see the ",(0,a.jsx)(n.a,{href:"/apis#tag/Reversal-Notifications/operation/finalAuthReversalNotification",children:"Final authorization reversal"})," for implementation details."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",metastring:'title="Example Final Authorization Reversal"',children:'{\r\n    "notification_id": "8bedf365-8442-4b6e-a480-7dad7b40ac44",\r\n    "type": "v1:pba:transaction:final_auth_reversed",\r\n    "created_at": "2023-06-24T14:15:22Z",\r\n    "data": {\r\n        "notification_id": "8bedf365-8442-4b6e-a480-7dad7b40ac44",\r\n        "transaction_id": "6182bde8-ee3e-4bd5-935e-e56507e0f809",\r\n        "tenant_reference_id": "31XXXX6723173606",\r\n        "network_transaction_ref": "awqcB1rPDuJIm4yKOQbqJUj5MvpdcH6E",\r\n        "network_message_ref": "CZLIzgNfeyMCabcsXp3liJPgSVGyQypHI2B",\r\n        "amount": 10.0,\r\n        "currency_code": "SGD",\r\n        "billing_amount": 10.0,\r\n        "billing_currency_code": "SGD",\r\n        "billing_exchange_rate": 1.0,\r\n        "settlement_amount": 10.0,\r\n        "settlement_currency_code": "SGD",\r\n        "settlement_exchange_rate": 1.0\r\n    }\r\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"pre-authorization-reversal",children:"Pre-authorization reversal"}),"\n",(0,a.jsx)(n.p,{children:"For a pre-authorization approval, there can be multiple pre-authorization reversal notifications, and each reversal can be for part or all of the hold balance that was set aside for this payment. When receiving these notifications, adjust or remove the original hold/available balance."}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsx)(n.p,{children:"If a pre-authorization is fully reversed, it will not be part of the clearing process."})}),"\n",(0,a.jsxs)(n.p,{children:["Please see the ",(0,a.jsx)(n.a,{href:"/apis#tag/Reversal-Notifications/operation/preAuthReversalNotification",children:"Pre-authorization reversal"})," for implementation details."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",metastring:'title="Example Pre-Authorization Reversal"',children:'{\r\n    "notification_id": "8bedf365-8442-4b6e-a480-7dad7b40ac44",\r\n    "type": "v1:pba:transaction:pre_auth_reversed",\r\n    "created_at": "2023-06-24T14:15:22Z",\r\n    "data": {\r\n        "notification_id": "8bedf365-8442-4b6e-a480-7dad7b40ac44",\r\n        "transaction_id": "6182bde8-ee3e-4bd5-935e-e56507e0f810",\r\n        "tenant_reference_id": "31XXXX6723173607",\r\n        "network_transaction_ref": "awqcB1rPDuJIm4yKOQbqJUj5MvpdcH6E",\r\n        "network_message_ref": "CZLIzgNfeyMCabcsXp3liJPgSVGyQypHI2C",\r\n        "amount": 50.0,\r\n        "currency_code": "SGD",\r\n        "billing_amount": 50.0,\r\n        "billing_currency_code": "SGD",\r\n        "billing_exchange_rate": 1.0,\r\n        "settlement_amount": 50.0,\r\n        "settlement_currency_code": "SGD",\r\n        "settlement_exchange_rate": 1.0\r\n    }\r\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"authorization-failed-notification",children:"Authorization failed notification"}),"\n",(0,a.jsx)(n.p,{children:"In the scenario where some error happened during the authorization process (e.g. because your endpoint returned a non-200 response or timed out), you may receive the authorization failed notification. This may apply for both final authorizations and pre-authorizations."}),"\n",(0,a.jsx)(n.p,{children:"If you have previously approved the authorization in your system, you are required to revert it based on this notification. But if the authorization is already declined in your system, you can disregard this notification."}),"\n",(0,a.jsx)(n.admonition,{type:"warning",children:(0,a.jsx)(n.p,{children:"Please take note of the special scenario where a pre-authorization failed for an incremental approval of an existing transaction. If this is the case, do not cancel the entirety of the hold balance but only the additional amount which was requested for incremental approval."})}),"\n",(0,a.jsxs)(n.p,{children:["Please see the ",(0,a.jsx)(n.a,{href:"/apis#tag/Reversal-Notifications/operation/authorizationFailedNotification",children:"Authorization failed notification"})," for implementation details."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",metastring:'title="Example Authorization failed notification"',children:'{\r\n    "notification_id": "3e6dd7ab-3360-4269-821e-a591bc94232c",\r\n    "type": "v1:pba:transaction:authorization_failed",\r\n    "created_at": "2024-06-06T18:47:21.175Z",\r\n    "data": {\r\n        "notification_id": "3e6dd7ab-3360-4269-821e-a591bc94232c",\r\n        "transaction_id": "2f8b3dd0-dc7a-4f93-96bf-0042d3ce697e",\r\n        "transaction_type": "final_auth",\r\n        "network_transaction_ref": "MCC0377270606",\r\n        "network_message_ref": "439951",\r\n        "amount": 30,\r\n        "currency": "PHP",\r\n        "billing_amount": 30,\r\n        "billing_currency_code": "PHP",\r\n        "billing_exchange_rate": 1,\r\n        "transaction_status": "declined",\r\n        "reason": "Tenant Service Error: no response from tenant, undefined",\r\n        "advised_action": "reverse_transaction"\r\n    }\r\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}}}]);